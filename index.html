<!doctype html>
<html lang="sk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wallet Watcher — Matrix Style</title>
  <style>
    body {margin:0; background:#000; color:#00ff66; font-family: "Courier New", monospace;}
    h1 {text-align:center; font-size:28px; margin-top:20px; text-shadow:0 0 6px #00ff66;}
    .container {max-width:800px; margin:0 auto; padding:20px;}
    .input-area {display:flex; gap:10px; justify-content:center; margin-top:20px;}
    input {flex:1; padding:10px; background:#020; border:1px solid #0f0; color:#0f0; border-radius:4px;}
    button {padding:10px 20px; background:#001900; color:#0f0; border:1px solid #0f0; cursor:pointer; border-radius:4px;}
    button:hover {background:#003000;}
    .status {text-align:center; margin-top:15px; color:#0f0; font-size:14px;}
    .card {background:#010; border:1px solid #003300; border-radius:8px; padding:15px; margin-top:20px; box-shadow:0 0 10px rgba(0,255,0,0.2);}
    table {width:100%; border-collapse:collapse; color:#0f0; margin-top:10px;}
    th,td {border-bottom:1px solid #003300; padding:8px; text-align:left; font-size:13px;}
    th {color:#00cc66;}
    .ref-btns {text-align:center; margin-top:20px;}
    .ref-btns a {margin:0 10px; padding:8px 18px; border:1px solid #0f0; text-decoration:none; color:#0f0; background:#001900; border-radius:4px;}
    .ref-btns a:hover {background:#003000;}
    .spinner {display:inline-block;width:14px;height:14px;border:2px solid rgba(0,255,0,0.2);border-top-color:#00ff66;border-radius:50%;animation:spin 1s linear infinite;margin-right:5px;}
    @keyframes spin {to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <h1>Wallet Watcher</h1>
  <div class="container">
    <div class="input-area">
      <input id="addr" placeholder="Zadaj adresu (ETH / BSC)">
      <button id="check">Check</button>
    </div>
    <div id="status" class="status">Čaká sa na akciu...</div>

    <div id="results" style="display:none;">
      <div class="card">
        <h3>Native Balances</h3>
        <table>
          <thead><tr><th>Chain</th><th>Balance</th><th>USD (≈)</th></tr></thead>
          <tbody id="native-body"></tbody>
        </table>
      </div>

      <div class="card">
        <h3>Token Holdings (ETH chain)</h3>
        <div id="tokens-area">—</div>
      </div>

      <div class="ref-btns">
        <a href="https://partner.bydfi.com/register?vipCode=Jg9qYE" target="_blank">Trade on BYDFI</a>
        <a href="https://www.bitunix.com/register?vipCode=SATTO" target="_blank">Register on Bitunix</a>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/ethers@6.8.3/dist/ethers.min.js"></script>
  <script>
    const ETH_RPC = 'https://cloudflare-eth.com';
    const BSC_RPC = 'https://bsc-dataseed.binance.org/';

    const btn = document.getElementById('check');
    const addrInput = document.getElementById('addr');
    const status = document.getElementById('status');
    const results = document.getElementById('results');
    const nativeBody = document.getElementById('native-body');
    const tokensArea = document.getElementById('tokens-area');

    function setStatus(text, busy=false){
      status.innerHTML = busy ? `<span class='spinner'></span>${text}` : text;
    }

    async function fetchJSON(url){
      try {const r = await fetch(url); return await r.json();} catch(e){return null;}
    }

    async function getNativeBalance(address, chain){
      try {
        const provider = new ethers.JsonRpcProvider(chain==='bsc'?BSC_RPC:ETH_RPC);
        const bal = await provider.getBalance(address);
        return Number(ethers.formatUnits(bal, 18));
      } catch(e){return null;}
    }

    async function getPrices(){
      const j = await fetchJSON('https://api.coingecko.com/api/v3/simple/price?ids=ethereum%2Cbinancecoin&vs_currencies=usd');
      return j ? {eth:j.ethereum.usd, bnb:j.binancecoin.usd} : {eth:null,bnb:null};
    }

    async function getTokens(address){
      const data = await fetchJSON(`https://api.ethplorer.io/getAddressInfo/${address}?apiKey=freekey`);
      return data && data.tokens ? data.tokens : [];
    }

    async function display(address){
      setStatus('Načítavam dáta...', true);
      results.style.display='none';
      nativeBody.innerHTML='';
      tokensArea.innerHTML='—';

      const prices = await getPrices();
      const ethBal = await getNativeBalance(address,'eth');
      const bscBal = await getNativeBalance(address,'bsc');

      const rows = [];
      if(ethBal!=null) rows.push(`<tr><td>Ethereum</td><td>${ethBal}</td><td>${(ethBal*prices.eth).toFixed(2)}</td></tr>`);
      if(bscBal!=null) rows.push(`<tr><td>BSC</td><td>${bscBal}</td><td>${(bscBal*prices.bnb).toFixed(2)}</td></tr>`);
      nativeBody.innerHTML = rows.join('');

      const tokens = await getTokens(address);
      if(tokens.length){
        let tHTML = '<table><thead><tr><th>Name</th><th>Symbol</th><th>Balance</th><th>USD</th></tr></thead><tbody>';
        for(const t of tokens){
          const info = t.tokenInfo||{};
          const name = info.name||'Unknown';
          const sym = info.symbol||'';
          const dec = info.decimals?Number(info.decimals):0;
          const bal = dec? (Number(t.balance)/Math.pow(10,dec)): Number(t.balance);
          const usd = (info.price && info.price.rate)? (bal*info.price.rate).toFixed(2) : '—';
          tHTML += `<tr><td>${name}</td><td>${sym}</td><td>${bal}</td><td>${usd}</td></tr>`;
        }
        tHTML += '</tbody></table>';
        tokensArea.innerHTML = tHTML;
      } else {
        tokensArea.innerHTML = '<div>Žiadne tokeny nenájdené.</div>';
      }

      results.style.display='block';
      setStatus('Hotovo.');
    }

    btn.onclick = ()=>{
      const a = addrInput.value.trim();
      if(!a){setStatus('Zadaj adresu.');return;}
      display(a);
    }

    addrInput.addEventListener('keyup', e=>{if(e.key==='Enter')btn.click();});
  </script>
</body>
</html>
